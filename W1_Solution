-- Create database & schema
CREATE DATABASE FROSTY_FRIDAY;
USE DATABASE FROSTY_FRIDAY;
CREATE SCHEMA FROSTY_FRIDAY_W1;

-- create stage and check what's inside
CREATE STAGE FROSTY_FRIDAY_W1_STAGE
URL = 's3://frostyfridaychallenges/challenge_1/';
LIST @FROSTY_FRIDAY_W1_STAGE;
SELECT $1 FROM @FROSTY_FRIDAY_W1_STAGE;

-- create file format
CREATE OR REPLACE FILE FORMAT FROSTY_FRIDAY_W1_FF
    SKIP_HEADER = 1
    TYPE = 'CSV'
    FIELD_DELIMITER = ',';
    
-- create table
CREATE or replace TABLE FROSTY_FRIDAY_W1_TABLE (
COLUMN_1 VARCHAR
);

-- copy into table
COPY INTO FROSTY_FRIDAY_W1_TABLE
FROM @FROSTY_FRIDAY_W1_STAGE
FILE_FORMAT = (format_name = FROSTY_FRIDAY_W1_FF)
;

select * FROM FROSTY_FRIDAY.FROSTY_FRIDAY_W1.FROSTY_FRIDAY_W1_TABLE;
